# 要件定義書 

## プロジェクト情報
- **プロジェクト名**: GEMM_v0_6_10_solo_ex1
- **作成日**: 2025-09-15

## 最適化対象
### コード取得方法
- 指定なし

### 対象ファイル
- PMが`/BaseCode`に並列化前のGEMMのコードとbashファイル・makefileを作成
- Fortranではなく C/C++ (CUDA含む) で実装すること

## 最適化の度合い（目標）
### 性能目標
- **目標性能**: GPUの理論ピーク性能に極限まで近づける
- 1ノード限界まで最適化を行うこと
- `1GPU` と `4GPU` 別に理論性能を算出せよ。

### 優先度
- [x] 精度保証
- [x] スループット最大化
- [x] スケーラビリティ向上　（GPU数・行列サイズ）

## 概要
### アプリケーション概要
シングルノードで行列積(GEMM)の最適化を行う

## 制約（指定）

### ハードウェア（サブシステム）
#### 選択されたスパコン
- **システム名**: 不老 (flow)

#### 利用可能なハードウェア
- [x] TypeII（GPUノード群）
- [x] 1ノードあたり4GPU
- [x] コンパイル等を除き、計算はログインノード上で実行しないこと

### SSH先で使用するディレクトリ
_remote_info に記載

### ジョブリソース（ノード数）

#### リソース制約
- シングルノードのみ
- 同時に投げられるジョブ数には上限がある
- ノードを占有するので、`プロセス`・`スレッド`・`GPU`数は無駄なく使える設定にすること
- ただし複数GPUに対応していないコード等の場合を除く

### ミドルウェア（コンパイラ・並列化モジュール）
#### コンパイラ選択肢
- _remote_infoを参考にせよ
- 特に理由がなければデフォルトのバージョンを使用

#### 並列化ライブラリ
##### CPU （必要に応じて）
- [ ] MPI
- [ ] OpenMP
- [ ] SIMD
##### GPU
- [ ] OpenACC (使用しても良い)
- [x] CUDA
##### 数値計算ライブラリ
- [ ] 使用しない
##### 仮想化(singularity)
- [ ] 使用しない

### 並列化戦略（実装順序や適用箇所）
#### 実装フェーズ
進化的探索

### 許容される精度（テストコード 指定/生成）

#### 入出力の型
- [x] double(64bit)

#### 演算精度
- Doubleの数値計算で一般的な精度を基準とせよ

#### 精度要件
- PMが妥当な目標精度を定め、全体に共有すること
- BLASのような数値計算ライブラリで一般的な精度を保証するテストルーチンを用意すること
- 必ず何らかの適切な方法で誤差を求め、ChangeLogに記入すること

### 予算（ジョブ）
#### 計算資源予算
- **最低消費ライン**: 100ポイント
- **目安**: 500ポイント
- **上限**: 1,000ポイント
#### TypeIIサブシステムのレート
経過時間1 秒につき 0.007 ポイントに使用GPU数を乗じて得たポイント数。

#### リソースグループ
_remote_infoを参考に、ジョブ単位で適切なものを選択して記録せよ

## 追加要件・制約

### 制限時間
下限: 120 min (2h)
目安: 150 min (2.5h)
上限: 180 min (3h)

### セキュリティ要件
- スパコンのセキュリティに関わるユーザ情報等はGitHubにpushする前に匿名化
- 可能な限り絶対パスの代わりに相対パスを用い、移植性を維持

### エージェント構成
必ず全エージェントの役割を兼任するSOLOだけで動くこと

### CD(Git Agent)を使用するか
#### GitHub連携
- [x] 使用する

#### CDへの追加指示
- `GitHub/📁`以下の`.gitignore`はプロジェクトルート直下のものをコピーし、必要に応じて修正
- GitHubを管理するCDエージェントは、性能に関わらず生成された全バージョンのコードをこまめにpushすること
- この`requirement_definition.md`等も含め、手元の状態を完全再現した匿名版をpushせよ。
- 他の研究者やエンジニアが、匿名化済みGitリポジトリをダウンロードして、`README.md`に沿って環境構築すれば、別のスパコン等でも最適化を継続できるように、漏れなくpushせよ
- _remote_infoの情報も手元で匿名化（commitメッセージには一切生のユーザIDを含めないこと）
- リポジトリのURLは、既に`git remote add origin`で設定済みである

#### SEへの追加指示
- 以下の2種類のグラフがpngとして定期的に保存され、ChangeLogの全てのデータがプロットされるように整備せよ
  - 階層別SOTA性能向上
  - 予算管理
- 保存されない場合、または結果があるのにプロットに反映されていない記録がある場合、原因を追究せよ
- 集計・可視化においては、ほぼ全責任と権限をSEが持つ
- usageを必ず読み、プロジェクトの仕様に沿って、優先的にPythonコードを修正せよ
- グラフはアスキーアートでは意味がない。作成されたpngを相対パスでmarkdownレポートに埋め込むこと

#### 全エージェントに伝えたい指示
- makeを除き、絶対にログインノードで実行しないよう、必ずバッチjobスクリプトを使用せよ
- 「世界トップクラスの性能」のような曖昧で大げさな表現は使わず、淡々と事実を記すこと
- 論文の実験評価およびデモを兼ねるため、不備・誇張・不正・改竄・虚偽申告は一切許さない
- 精度要件を満たさないコードはグラフから除外、または性能0としてプロットせよ
- `cuBLAS`や`MKL`のような数値計算ライブラリを使用してはならない。それらの性能にどこまで近づけるかに興味がある
- 最適化に関するスクリプトは手元のPCに残る形で作成し、スパコンに転送すること。逆にスパコン上の巨大な実行ファイル(.outなど)を手元にダウンロードする必要はない

---

## 自動生成情報（PM記入）
- **不足項目**: [自動記入]